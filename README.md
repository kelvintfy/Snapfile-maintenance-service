# URL + Maintenance service

## Overview

This service contains 2 sections:
**URL section**: Handles creating and updating MetaFiles. Uses this MetaFiles to enforce access constraints.
**Maintainer section**: Handles delete and sending out the appropriate delete requests for expired MetaFiles.

## How to run

Should hopefully just run after this on **port 4002**

```sh
npm start
```

## Changes from last push

- Added maintainer service into this service
- Now sends request to USER service

## MetaFile Schema

The MetaFile contains all constraints for the file that the URL service enforces. Currently there are only 2
constraints, **access limt** and **time limit**.

### Handled by service

| Title | Type | Note |
| ------ | ------ | ------ |
| _id | String |  autogenerated |
| availability | Boolean |  Created by service |
| createdAt | datetime |  autogenerated |
| updatedAt timestamps | datetime |  autogenerated |
| __v | Number |   |

### Created by the User

Information regarding what to be sending in a json file

| Title | Type | Required | Default | Constraints | Note |
| ------| ---- | -------- | ------- | ----------- | ---- |
| Name | String | YES |  | 3 < char length < 99> |  |
| accessLimit | Number | NO |  | 0 < Value |  |
| timeLimit | Boolean | NO  | Week from createdAt time | E.g. '**2021-04-15T14:47:
07.545Z**'  | Have yet to implement better way of handling time so you don't need to include the specific time if you don't want to |
| fileId | String | YES |  |  |  |

See models/metaFiles.js for the coded version.

## Routes that work

### Get Meta Files

| Get | result | Note |
| ------ | ------ | ------ |
| /meta/get | Returns all the json files | Will get rid of soon just for testing purposes|
| /meta/get/:id | gets specific MetaFile | The generated _ID is used to get the MetaFile|

#### /meta/get/:id

If the user has included an access limit then URL service decrement access limit after retrieving file.

### Add Meta Files

| Post | result | Note |
| ------ | ------ | ------ |
| /meta/add | Adds json file from request | |

Example of JSON file using /meta/add:

```json
{
  "name": "Banana",
  "accessLimit": 3,
  "timeLimit": null,
  "fileId": "lksdjflksdjfsd"
}
```

Results of this JSON file is a meta file:

```json
{
  "_id": "<id_gen_by_mongoose>",
  "name": "Banana",
  "accessLimit": 3,
  "fileId": "lksdjflksdjfsd",
  "timeLimit": "YYYY-MM-DD",
  "availability": true,
  "createdAt": "<date_by_mongoose>",
  "updatedAt": "<date_by_mongoose>",
  "__v": 0
}
```

### Delete Meta Files

| Delete | result | Note |
| ------ | ------ | ------ |
| /meta/delete/:id | Deletes MetaFile after sending a request to USER to delete file | |
